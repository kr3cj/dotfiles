[[ $- = *i* ]] || return

#  troubleshooting
# [[ ${HISTSIZE} -lt 1000000 ]] && echo -e "\nSomething has overridden \${HISTSIZE} to ${HISTSIZE}!!!\n"

[[ -f ~/.base_homeshick_vars ]] && source ~/.base_homeshick_vars
export IS_OSX="false"
export IS_LINUX="false"
case "$(uname)" in
  Darwin)
    IS_OSX="true" ;;
  Linux)
    IS_LINUX="true" ;;
  *)
    echo "Unable to determine Linux or OSX" ;;
esac

${IS_OSX} || return
export VAULT_ADDR="https://vault.${CUSTOM_WORK_DOMAINS[2]}:8200"
export VAULT_CLIENT_TIMEOUT=2
# vault authentication, if necessary
if ! vault token lookup &> /dev/null ; then
  echo "Must re-authenticate with VAULT (${VAULT_ADDR}...)"
  lpass show --password --clip LDAP
  vault login -method=ldap username=${CUSTOM_LDAP_NAME} > /dev/null
  vault token renew -increment=10h > /dev/null
  pbcopy </dev/null
fi
